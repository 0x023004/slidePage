!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.slidePage=e():t.slidePage=e()}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";i.r(e);const s=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}var i={getQueryParam:function(t=location.href){const e=t.match(/([^?=&]+)(=([^&]*))/g);return!!e&&e.reduce((t,e)=>(t[e.slice(0,e.indexOf("="))]=e.slice(e.indexOf("=")+1),t),{})},extend:function(t,e){for(let i in e)t[i]=e[i];return t},isEqualNode:function(t,e){var i=t.nodeName===e.nodeName,s=t.nodeType===e.nodeType,n=t.innerHTML===e.innerHTML;return t.className.replace(/ transition/g,"")===e.className.replace(/ transition/g,"")&&i&&s&&n},isDOM:function(t){if(t instanceof NodeList||t instanceof HTMLCollection&&t.length>0){for(var e=0,i=0,s=t.length;i<s;i++)t[i]instanceof Element&&e++;return e===s}return t instanceof Element}},s={},n=(new Date).getTime(),a={wheelFunc:function(t){t=t||window.event;if(!this.isScroll){var e=(new Date).getTime(),i=e-n;n=e,i<=50||(t.wheelDeltaY<0||t.wheelDelta<0||t.detail>0?this.canSlide&&this.canNext&&this.slideNext():(t.wheelDeltaY>0||t.wheelDelta>0||t.detail<0)&&this.canSlide&&this.canPrev&&this.slidePrev())}},touchStart:function(t){this.canSlide?s.startpoint=t.targetTouches[0].clientY:s.startpoint=-1},touchMove:function(t){if(-1===s.startpoint)return t.preventDefault(),!1;var e=t.targetTouches[0].clientY-s.startpoint;!this.canPrev&&e>5&&(this.isScroll=!0),!this.canNext&&e<-5&&(this.isScroll=!0),!this.isScroll&&t.preventDefault(),this.opt.dragMode&&this.canSlide&&1!=this.isScroll&&(e<-5&&this.count>this.page&&this.canNext&&(this.items[this.page-1].style.transform="translate3d(0, "+e.toFixed(2)+"px, 0)",this.items[this.page].style.transform="translate3d(0, "+(window.innerHeight+e).toFixed(2)+"px, 0)",s.endpoint=t.targetTouches[0].clientY),e>5&&this.page>1&&this.canPrev&&(this.items[this.page-2].style.transform="translate3d(0, -"+(window.innerHeight-e).toFixed(2)+"px, 0)",this.items[this.page-1].style.transform="translate3d(0, "+e.toFixed(2)+"px, 0)",s.endpoint=t.targetTouches[0].clientY)),this.opt.dragMode||(s.endpoint=t.targetTouches[0].clientY)},touchEnd:function(t){if(0===s.endpoint||-1===s.startpoint)return!1;var e=s.endpoint-s.startpoint;if(this.opt.dragMode){var i=window.innerHeight/4;e<-1*i?this.canSlide&&this.canNext&&this.slideNext():e>i?this.canSlide&&this.canPrev&&this.slidePrev():e>-1*i&&e<i&&r.resetSlideForDrag()}else s.endpoint-s.startpoint<-60?this.canSlide&&this.canNext&&this.slideNext():s.endpoint-s.startpoint>60&&this.canSlide&&this.canPrev&&this.slidePrev();s.startpoint=0,s.endpoint=0},transitionEnd:function(t){console.log(t.target),i.isEqualNode(t.target,this.items[this.page-1])&&(this.opt.dragMode&&(this.items[this.page-1].classList.remove("transition"),this.items[this.page-2]&&this.items[this.page-2].classList.remove("transition"),this.items[this.page]&&this.items[this.page].classList.remove("transition")),"next"==this.direction?(this.opt.after(this.page-1,this.direction,this.page),this.opt.refresh&&r.resetAnimation.call(this,this.page-2)):"prev"==this.direction&&(this.opt.after(this.page+1,this.direction,this.page),this.opt.refresh&&r.resetAnimation.call(this,this.page)),this.canSlide=!0)}},r={slideScroll:function(t,e){var i=this.items[t].children[0].offsetHeight,s=window.innerHeight,n=function(t){var e=window.innerHeight,s=i==this.items[t].scrollTop+e,n=0==this.items[t].scrollTop;this.canPrev=n&&!s,this.canNext=s&&!n,this.isScroll=!(s||n)}.bind(this,t);"removeListener"!=e?i-s>10?(this.items[t].children[0].children[0].focus(),n(),"next"==this.direction?this.items[t].scrollTop=0:"prev"==this.direction&&(this.items[t].scrollTop=i-s),this.items[t].addEventListener("scroll",n)):(this.canPrev=!0,this.canNext=!0,this.isScroll=!1):this.items[t].removeEventListener("scroll",n)},resetSlideForDrag:function(){this.canSlide=!1,this.items[this.page-1].classList.add("transition"),this.items[this.page-1].style.transform="translate3d(0, 0, 0)",this.items[this.page-2]&&(this.items[this.page-2].classList.add("transition"),this.items[this.page-2].style.transform="translate3d(0, -100%, 0)"),this.items[this.page]&&(this.items[this.page].classList.add("transition"),this.items[this.page].style.transform="translate3d(0, 100%, 0)")},resetAnimation:function(t){if(this.opt.useAnimation&&this.opt.refresh){if(!this.items[t])return!1;var e=this.items[t].querySelectorAll(".step"),i=this.items[t].querySelectorAll(".lazy");if(e.length>0)for(var s of Array.from(e))s.style.visibility="hidden",s.style.animationName="__"+window.getComputedStyle(s).animationName;if(i.length>0)for(var s of Array.from(i))s.style.visibility="hidden",s.style.animationName="__"+window.getComputedStyle(s).animationName}},runAnimation:function(t,e){if(this.opt.useAnimation){var i=this.items[t].querySelectorAll(e||".step");for(var s of Array.from(i))n(s);function n(t){var e=t.getAttribute("data-delay")||100,i=setTimeout(function(){t.style.visibility="",t.style.animationName="",clearTimeout(i)},e)}}},initAnimation:function(t,e){if(this.opt.useAnimation){var i=this.container.querySelectorAll(".step"),s=this.container.querySelectorAll(".lazy");if(i.length>0)for(var n of Array.from(i))n.style.visibility="hidden",n.style.animationName="__"+window.getComputedStyle(n).animationName;if(s.length>0)for(var n of Array.from(s))n.style.visibility="hidden",n.style.animationName="__"+window.getComputedStyle(n).animationName;r.runAnimation.call(this,e)}for(var a,o=0;a=this.items[o];o++)o===e?a.style.transform="translate3d(0, 0, 0)":o<e?a.style.transform="translate3d(0, -100%, 0)":o>e&&(a.style.transform="translate3d(0, 100%, 0)"),this.opt.dragMode||function(t){var e=setTimeout(function(){t.classList&&t.classList.add instanceof Function&&t.classList.add("transition"),clearTimeout(e)})}(a)},initEvent:function(){console.log(this),this.opt.useWheel&&(document.addEventListener("DOMMouseScroll",this.eventHandler.wheelFunc,!!t&&{passive:!0}),document.addEventListener("mousewheel",this.eventHandler.wheelFunc,!!t&&{passive:!0})),this.opt.useSwipe&&(s={startpoint:0,endpoint:0},this.container.addEventListener("touchstart",this.eventHandler.touchStart,!!t&&{passive:!0}),this.container.addEventListener("touchmove",this.eventHandler.touchMove),this.container.addEventListener("touchend",this.eventHandler.touchEnd,!!t&&{passive:!0})),this.container.addEventListener("transitionend",this.eventHandler.transitionEnd)}};return class{constructor(t){var e={page:1*i.getQueryParam("page")||1,slidePages:".slide-page",slideContainer:".slide-container",after:function(){},before:function(){},refresh:!1,useWheel:!0,useSwipe:!0,useAnimation:!0,dragMode:!1};for(var s in this.canSlide=!0,this.canNext=!0,this.canPrev=!0,this.isScroll=!1,this.opt=i.extend(e,t),this.page=this.opt.page,this.container=i.isDOM(this.opt.slideContainer)?this.opt.slideContainer:document.querySelector(this.opt.slideContainer),this.items=i.isDOM(this.opt.slidePages)?this.opt.slidePages:document.querySelectorAll(this.opt.slidePages),this.count=this.items.length,this.direction="",this.eventHandler={},a)this.eventHandler[s]=a[s].bind(this);r.initEvent.call(this),r.slideScroll.call(this,this.page-1),r.initAnimation.call(this,this.items,this.page-1),this.slideTo(this.page)}slideNext(t){if(this.count<=this.page)return!1;this.opt.dragMode&&(this.items[this.page-1].classList.add("transition"),this.items[this.page].classList.add("transition")),this.direction="next",r.slideScroll.call(this,this.page-1,"removeListener"),r.slideScroll.call(this,this.page),this.items[this.page-1].style.transform="translate3d(0, -100%, 0)",this.items[this.page].style.transform="translate3d(0, 0, 0)",this.page++,this.opt.before(this.page-1,this.direction,this.page),t||(this.canSlide=!1,r.runAnimation.call(this,this.page-1))}slidePrev(t){if(1>=this.page)return!1;this.opt.dragMode&&(this.items[this.page-2].classList.add("transition"),this.items[this.page-1].classList.add("transition")),this.direction="prev",r.slideScroll.call(this,this.page-1,"removeListener"),r.slideScroll.call(this,this.page-2),this.items[this.page-2].style.transform="translate3d(0, 0, 0)",this.items[this.page-1].style.transform="translate3d(0, 100%, 0)",this.page--,this.opt.before(this.page+1,this.direction,this.page),t||(this.canSlide=!1,r.runAnimation.call(this,this.page-1))}slideTo(t){if(t>=1&&t<=this.count){if(t==this.page)return!1;if(t>this.page){for(var e=this.page+1;e<t;e++)this.slideNext("optimize");this.slideNext()}else if(t<this.page){for(e=this.page-1;e>t;e--)this.slidePrev("optimize");this.slidePrev()}}}slideFire(t){var e=t?t-1:this.page-1;r.runAnimation(this,e,".lazy")}destroy(){if(this.opt.useAnimation){this.items.length;var t=this.container.querySelectorAll(".step"),e=this.container.querySelectorAll(".lazy");if(t.length>0)for(var i of t)i.style.visibility="";if(e.length>0)for(var i of e)i.style.visibility="";r.runAnimation.call(this,0)}this.opt.useWheel&&(document.removeEventListener("DOMMouseScroll",this.eventHandler.wheelFunc),document.removeEventListener("mousewheel",this.eventHandler.wheelFunc),this.items[this.page-1].style.transform="translate3d(0, 0, 0)"),this.opt.useSwipe&&(this.container.removeEventListener("touchstart",this.eventHandler.touchStart),this.container.removeEventListener("touchmove",this.eventHandler.touchMove),this.container.removeEventListener("touchend",this.eventHandler.touchEnd)),this.container.removeEventListener("transitionend",this.eventHandler.transitionEnd)}update(t){this.canSlide=!0,this.canNext=!0,this.canPrev=!0;for(var e=i.isDOM(t)?t:document.querySelectorAll(this.opt.slidePages),s=0,n=e.length;s<n;s++){if(this.items[this.page-1]&&i.isEqualNode(this.items[this.page-1],e[s])){this.page=s+1;break}s===n-1&&(this.page=1)}this.items=e,this.count=this.items.length,this.slideTo(this.page),r.initAnimation.call(this,this.items,this.page-1),r.slideScroll.call(this,this.page-1)}}}();e.default=s}]).default});